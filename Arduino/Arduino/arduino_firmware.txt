#include <Servo.h>

Servo esc;
const int escPin = 9;
String inputString = "";

void setup() {
  Serial.begin(115200);
  esc.attach(escPin);

  // Arma o ESC (espera sinal baixo por 3s)
  Serial.println("Arming ESC...");
  esc.writeMicroseconds(1000);
  delay(3000);
  Serial.println("ESC armed.");
}

void loop() {
  while (Serial.available()) {
    char inChar = (char)Serial.read();
    if (inChar == '\n') {
      int pwmValue = inputString.toInt();
      pwmValue = constrain(pwmValue, 1000, 2000);
      esc.writeMicroseconds(pwmValue);

      Serial.print("PWM recebido: ");
      Serial.println(pwmValue);

      inputString = ""; // Limpa o buffer
    } else {
      inputString += inChar;
    }
  }
}
